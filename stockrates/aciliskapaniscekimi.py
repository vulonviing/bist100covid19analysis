

import pandas as pd
import yfinance as yf
import numpy as np
import xarray as xr

df = pd.read_csv(r"C:\Users\emrec\Desktop\TUBITAK 22 DOSYASI\datastore manipulation\finaldata.csv")
dfstocks = df["HISSE"]
stocks = [s + ".IS" for s in dfstocks]

xarray_3d = xr.Dataset({
    stocks[0]: yf.Ticker(stocks[0]).history(start="2019-01-01", end="2020-01-15"),
    stocks[1]: yf.Ticker(stocks[1]).history(start="2019-01-01", end="2020-01-15"),
    stocks[2]: yf.Ticker(stocks[2]).history(start="2019-01-01", end="2020-01-15"),
    stocks[3]: yf.Ticker(stocks[3]).history(start="2019-01-01", end="2020-01-15"),
    stocks[4]: yf.Ticker(stocks[4]).history(start="2019-01-01", end="2020-01-15"),
    stocks[5]: yf.Ticker(stocks[5]).history(start="2019-01-01", end="2020-01-15"),
    stocks[6]: yf.Ticker(stocks[6]).history(start="2019-01-01", end="2020-01-15"),
    stocks[7]: yf.Ticker(stocks[7]).history(start="2019-01-01", end="2020-01-15"),
    stocks[8]: yf.Ticker(stocks[8]).history(start="2019-01-01", end="2020-01-15"),
    stocks[9]: yf.Ticker(stocks[9]).history(start="2019-01-01", end="2020-01-15"),
    stocks[10]: yf.Ticker(stocks[10]).history(start="2019-01-01", end="2020-01-15"),
    stocks[11]: yf.Ticker(stocks[11]).history(start="2019-01-01", end="2020-01-15"),
    stocks[12]: yf.Ticker(stocks[12]).history(start="2019-01-01", end="2020-01-15"),
    stocks[13]: yf.Ticker(stocks[13]).history(start="2019-01-01", end="2020-01-15"),
    stocks[14]: yf.Ticker(stocks[14]).history(start="2019-01-01", end="2020-01-15"),
    stocks[15]: yf.Ticker(stocks[15]).history(start="2019-01-01", end="2020-01-15"),
    stocks[16]: yf.Ticker(stocks[16]).history(start="2019-01-01", end="2020-01-15"),
    stocks[17]: yf.Ticker(stocks[17]).history(start="2019-01-01", end="2020-01-15"),
    stocks[18]: yf.Ticker(stocks[18]).history(start="2019-01-01", end="2020-01-15"),
    stocks[19]: yf.Ticker(stocks[19]).history(start="2019-01-01", end="2020-01-15"),
    stocks[20]: yf.Ticker(stocks[20]).history(start="2019-01-01", end="2020-01-15"),
    stocks[21]: yf.Ticker(stocks[21]).history(start="2019-01-01", end="2020-01-15"),
    stocks[22]: yf.Ticker(stocks[22]).history(start="2019-01-01", end="2020-01-15"),
    stocks[23]: yf.Ticker(stocks[23]).history(start="2019-01-01", end="2020-01-15"),
    stocks[24]: yf.Ticker(stocks[24]).history(start="2019-01-01", end="2020-01-15"),
    stocks[25]: yf.Ticker(stocks[25]).history(start="2019-01-01", end="2020-01-15"),
    stocks[26]: yf.Ticker(stocks[26]).history(start="2019-01-01", end="2020-01-15"),
    stocks[27]: yf.Ticker(stocks[27]).history(start="2019-01-01", end="2020-01-15"),
    stocks[28]: yf.Ticker(stocks[28]).history(start="2019-01-01", end="2020-01-15"),
    stocks[29]: yf.Ticker(stocks[29]).history(start="2019-01-01", end="2020-01-15"),
    stocks[30]: yf.Ticker(stocks[30]).history(start="2019-01-01", end="2020-01-15"),
    stocks[31]: yf.Ticker(stocks[31]).history(start="2019-01-01", end="2020-01-15"),
    stocks[32]: yf.Ticker(stocks[32]).history(start="2019-01-01", end="2020-01-15"),
    stocks[33]: yf.Ticker(stocks[33]).history(start="2019-01-01", end="2020-01-15"),
    stocks[34]: yf.Ticker(stocks[34]).history(start="2019-01-01", end="2020-01-15"),
    stocks[35]: yf.Ticker(stocks[35]).history(start="2019-01-01", end="2020-01-15"),
    stocks[36]: yf.Ticker(stocks[36]).history(start="2019-01-01", end="2020-01-15"),
    stocks[37]: yf.Ticker(stocks[37]).history(start="2019-01-01", end="2020-01-15"),
    stocks[38]: yf.Ticker(stocks[38]).history(start="2019-01-01", end="2020-01-15"),
    stocks[39]: yf.Ticker(stocks[39]).history(start="2019-01-01", end="2020-01-15"),
    stocks[40]: yf.Ticker(stocks[40]).history(start="2019-01-01", end="2020-01-15"),
    stocks[41]: yf.Ticker(stocks[41]).history(start="2019-01-01", end="2020-01-15"),
    stocks[42]: yf.Ticker(stocks[42]).history(start="2019-01-01", end="2020-01-15"),
    stocks[43]: yf.Ticker(stocks[43]).history(start="2019-01-01", end="2020-01-15"),
    stocks[44]: yf.Ticker(stocks[44]).history(start="2019-01-01", end="2020-01-15"),
    stocks[45]: yf.Ticker(stocks[45]).history(start="2019-01-01", end="2020-01-15"),
    stocks[46]: yf.Ticker(stocks[46]).history(start="2019-01-01", end="2020-01-15"),
    stocks[47]: yf.Ticker(stocks[47]).history(start="2019-01-01", end="2020-01-15"),
    stocks[48]: yf.Ticker(stocks[48]).history(start="2019-01-01", end="2020-01-15"),
    stocks[49]: yf.Ticker(stocks[49]).history(start="2019-01-01", end="2020-01-15"),
    stocks[50]: yf.Ticker(stocks[50]).history(start="2019-01-01", end="2020-01-15"),
    stocks[51]: yf.Ticker(stocks[51]).history(start="2019-01-01", end="2020-01-15"),
    stocks[52]: yf.Ticker(stocks[52]).history(start="2019-01-01", end="2020-01-15"),
    stocks[53]: yf.Ticker(stocks[53]).history(start="2019-01-01", end="2020-01-15"),
    stocks[54]: yf.Ticker(stocks[54]).history(start="2019-01-01", end="2020-01-15"),
    stocks[55]: yf.Ticker(stocks[55]).history(start="2019-01-01", end="2020-01-15"),
    stocks[56]: yf.Ticker(stocks[56]).history(start="2019-01-01", end="2020-01-15"),
    stocks[57]: yf.Ticker(stocks[57]).history(start="2019-01-01", end="2020-01-15"),
    stocks[58]: yf.Ticker(stocks[58]).history(start="2019-01-01", end="2020-01-15"),
    stocks[59]: yf.Ticker(stocks[59]).history(start="2019-01-01", end="2020-01-15"),
    stocks[60]: yf.Ticker(stocks[60]).history(start="2019-01-01", end="2020-01-15"),
    stocks[61]: yf.Ticker(stocks[61]).history(start="2019-01-01", end="2020-01-15"),
    stocks[62]: yf.Ticker(stocks[62]).history(start="2019-01-01", end="2020-01-15"),
    stocks[63]: yf.Ticker(stocks[63]).history(start="2019-01-01", end="2020-01-15"),
    stocks[64]: yf.Ticker(stocks[64]).history(start="2019-01-01", end="2020-01-15"),
    stocks[65]: yf.Ticker(stocks[65]).history(start="2019-01-01", end="2020-01-15"),
    stocks[66]: yf.Ticker(stocks[66]).history(start="2019-01-01", end="2020-01-15"),
    stocks[67]: yf.Ticker(stocks[67]).history(start="2019-01-01", end="2020-01-15"),
    stocks[68]: yf.Ticker(stocks[68]).history(start="2019-01-01", end="2020-01-15"),
    stocks[69]: yf.Ticker(stocks[69]).history(start="2019-01-01", end="2020-01-15"),
    stocks[70]: yf.Ticker(stocks[70]).history(start="2019-01-01", end="2020-01-15"),
    stocks[71]: yf.Ticker(stocks[71]).history(start="2019-01-01", end="2020-01-15"),
    stocks[72]: yf.Ticker(stocks[72]).history(start="2019-01-01", end="2020-01-15"),
    stocks[73]: yf.Ticker(stocks[73]).history(start="2019-01-01", end="2020-01-15"),
    stocks[74]: yf.Ticker(stocks[74]).history(start="2019-01-01", end="2020-01-15"),
    stocks[75]: yf.Ticker(stocks[75]).history(start="2019-01-01", end="2020-01-15"),
    stocks[76]: yf.Ticker(stocks[76]).history(start="2019-01-01", end="2020-01-15"),
    stocks[77]: yf.Ticker(stocks[77]).history(start="2019-01-01", end="2020-01-15"),
    stocks[78]: yf.Ticker(stocks[78]).history(start="2019-01-01", end="2020-01-15"),
    stocks[79]: yf.Ticker(stocks[79]).history(start="2019-01-01", end="2020-01-15"),
    stocks[80]: yf.Ticker(stocks[80]).history(start="2019-01-01", end="2020-01-15"),
    stocks[81]: yf.Ticker(stocks[81]).history(start="2019-01-01", end="2020-01-15"),
    stocks[82]: yf.Ticker(stocks[82]).history(start="2019-01-01", end="2020-01-15"),
    stocks[83]: yf.Ticker(stocks[83]).history(start="2019-01-01", end="2020-01-15"),
    stocks[84]: yf.Ticker(stocks[84]).history(start="2019-01-01", end="2020-01-15"),
    stocks[85]: yf.Ticker(stocks[85]).history(start="2019-01-01", end="2020-01-15"),
    stocks[86]: yf.Ticker(stocks[86]).history(start="2019-01-01", end="2020-01-15"),
    stocks[87]: yf.Ticker(stocks[87]).history(start="2019-01-01", end="2020-01-15"),
    stocks[88]: yf.Ticker(stocks[88]).history(start="2019-01-01", end="2020-01-15"),
    stocks[89]: yf.Ticker(stocks[89]).history(start="2019-01-01", end="2020-01-15"),
    stocks[90]: yf.Ticker(stocks[90]).history(start="2019-01-01", end="2020-01-15"),
    stocks[91]: yf.Ticker(stocks[91]).history(start="2019-01-01", end="2020-01-15"),
    stocks[92]: yf.Ticker(stocks[92]).history(start="2019-01-01", end="2020-01-15"),
    stocks[93]: yf.Ticker(stocks[93]).history(start="2019-01-01", end="2020-01-15"),
    stocks[94]: yf.Ticker(stocks[94]).history(start="2019-01-01", end="2020-01-15"),
    stocks[95]: yf.Ticker(stocks[95]).history(start="2019-01-01", end="2020-01-15"),
    stocks[96]: yf.Ticker(stocks[96]).history(start="2019-01-01", end="2020-01-15"),
    stocks[97]: yf.Ticker(stocks[97]).history(start="2019-01-01", end="2020-01-15"),
    stocks[98]: yf.Ticker(stocks[98]).history(start="2019-01-01", end="2020-01-15"),
    stocks[99]: yf.Ticker(stocks[99]).history(start="2019-01-01", end="2020-01-15"),
    stocks[100]: yf.Ticker(stocks[100]).history(start="2019-01-01", end="2020-01-15"),
    stocks[101]: yf.Ticker(stocks[101]).history(start="2019-01-01", end="2020-01-15"),
    stocks[102]: yf.Ticker(stocks[102]).history(start="2019-01-01", end="2020-01-15"),
    stocks[103]: yf.Ticker(stocks[103]).history(start="2019-01-01", end="2020-01-15"),
    stocks[104]: yf.Ticker(stocks[104]).history(start="2019-01-01", end="2020-01-15"),
    stocks[105]: yf.Ticker(stocks[105]).history(start="2019-01-01", end="2020-01-15"),
    stocks[106]: yf.Ticker(stocks[106]).history(start="2019-01-01", end="2020-01-15"),
    stocks[107]: yf.Ticker(stocks[107]).history(start="2019-01-01", end="2020-01-15"),
    stocks[108]: yf.Ticker(stocks[108]).history(start="2019-01-01", end="2020-01-15"),
    stocks[109]: yf.Ticker(stocks[109]).history(start="2019-01-01", end="2020-01-15"),
    stocks[110]: yf.Ticker(stocks[110]).history(start="2019-01-01", end="2020-01-15"),
    stocks[111]: yf.Ticker(stocks[111]).history(start="2019-01-01", end="2020-01-15"),
    stocks[112]: yf.Ticker(stocks[112]).history(start="2019-01-01", end="2020-01-15"),
    stocks[113]: yf.Ticker(stocks[113]).history(start="2019-01-01", end="2020-01-15"),
    stocks[114]: yf.Ticker(stocks[114]).history(start="2019-01-01", end="2020-01-15"),
    stocks[115]: yf.Ticker(stocks[115]).history(start="2019-01-01", end="2020-01-15"),
    stocks[116]: yf.Ticker(stocks[116]).history(start="2019-01-01", end="2020-01-15"),
    stocks[117]: yf.Ticker(stocks[117]).history(start="2019-01-01", end="2020-01-15"),
    stocks[118]: yf.Ticker(stocks[118]).history(start="2019-01-01", end="2020-01-15"),
    stocks[119]: yf.Ticker(stocks[119]).history(start="2019-01-01", end="2020-01-15"),
    stocks[120]: yf.Ticker(stocks[120]).history(start="2019-01-01", end="2020-01-15"),
    stocks[121]: yf.Ticker(stocks[121]).history(start="2019-01-01", end="2020-01-15"),
    stocks[122]: yf.Ticker(stocks[122]).history(start="2019-01-01", end="2020-01-15"),
    stocks[123]: yf.Ticker(stocks[123]).history(start="2019-01-01", end="2020-01-15"),
    stocks[124]: yf.Ticker(stocks[124]).history(start="2019-01-01", end="2020-01-15"),
    stocks[125]: yf.Ticker(stocks[125]).history(start="2019-01-01", end="2020-01-15"),
    stocks[126]: yf.Ticker(stocks[126]).history(start="2019-01-01", end="2020-01-15"),
    stocks[127]: yf.Ticker(stocks[127]).history(start="2019-01-01", end="2020-01-15"),
    stocks[128]: yf.Ticker(stocks[128]).history(start="2019-01-01", end="2020-01-15"),
    stocks[129]: yf.Ticker(stocks[129]).history(start="2019-01-01", end="2020-01-15"),
    stocks[130]: yf.Ticker(stocks[130]).history(start="2019-01-01", end="2020-01-15"),
    stocks[131]: yf.Ticker(stocks[131]).history(start="2019-01-01", end="2020-01-15"),
    stocks[132]: yf.Ticker(stocks[132]).history(start="2019-01-01", end="2020-01-15"),
    stocks[133]: yf.Ticker(stocks[133]).history(start="2019-01-01", end="2020-01-15"),
    stocks[134]: yf.Ticker(stocks[134]).history(start="2019-01-01", end="2020-01-15")
    })

df_3d = xarray_3d.to_dataframe()

df_3d.to_csv(r"C:\Users\emrec\Desktop\TUBITAK 22 DOSYASI\test.csv")
